<mat-card class="main-card">
  <mat-card-title>Administrar consulta</mat-card-title>
  <mat-card-content>
    <div
      style="
        display: flex;
        flex-direction: row;
        justify-content: center;
        align-items: start;
        gap: 1rem;
        margin-top: 1rem;
      "
    >
      <div
        style="
          border: 1px solid gray;
          padding: 1rem;
          border-radius: 5px;
        "
      >
        <app-appointment-info [appointment]="appointment"></app-appointment-info>
      </div>
      <div
        style="
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        border: 1px solid gray;
        padding: 1rem;
        border-radius: 5px;
        gap: 1rem;
      "
      >
        <div>
          <h4>¿Asignar examenes?</h4>
          <table mat-table [dataSource]="testTypes">
            <ng-container matColumnDef="id">
              <th mat-header-cell *matHeaderCellDef>ID</th>
              <td mat-cell *matCellDef="let testType">{{ testType.id }}</td>
            </ng-container>
            <ng-container matColumnDef="selected">
              <th mat-header-cell *matHeaderCellDef></th>
              <td mat-cell *matCellDef="let testType">
                <mat-checkbox [(ngModel)]="testType.selected" name="specialityCheckbox"></mat-checkbox>
              </td>
            </ng-container>

            <ng-container matColumnDef="name">
              <th mat-header-cell *matHeaderCellDef>Nombre</th>
              <td mat-cell *matCellDef="let testType">{{ testType.name }}</td>
            </ng-container>

            <ng-container matColumnDef="description">
              <th mat-header-cell *matHeaderCellDef>Descripción</th>
                  <td mat-cell *matCellDef="let testType"
                      style="
                        max-width: 385px;
                        overflow: auto;
                      "
                  >
                    <div
                      style="
                          display: flex;
                          flex-direction: row;
                          align-items: center;
                      "
                    >
                      <button mat-icon-button type="button" (click)="showDescriptionDialog(testType)">
                        <mat-icon>sms</mat-icon>
                      </button>
                      <span
                        style="
                            overflow: hidden;
                            text-overflow: ellipsis;
                            white-space: nowrap;
                          "
                      >
                          {{ testType.description }}
                        </span>
                    </div>
                  </td>
            </ng-container>


            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let speciality; columns: displayedColumns;"></tr>
          </table>
        </div>
        <div
          style="
          display: flex;
          flex-direction: column;
          justify-content: center;
          align-items: center;
          gap: 0.3rem;"
        >
          <h4>Reporte de finalización</h4>
          <mat-form-field appearance="outline">
            <mat-label>Reporte</mat-label>
            <textarea matInput [(ngModel)]="finalReport"></textarea>
          </mat-form-field>
          <button mat-stroked-button color="primary" (click)="finishAppointment()">
            <mat-icon>check</mat-icon>
            FINALIZAR CONSULTA
          </button>
        </div>
      </div>
    </div>
  </mat-card-content>
</mat-card>
